
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Mbizo High School - Smart Education Platform</title>
    <style>
* {
    margin: 0;
    padding: 0;
    box-sizing: border-box;
}

:root {
    --navy: #0a1e42;
    --gold: #d4af37;
    --white: #ffffff;
    --light-gray: #f5f5f5;
    --dark-gray: #333333;
    --success: #28a745;
    --danger: #dc3545;
}

body {
    font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
    color: var(--dark-gray);
    line-height: 1.6;
    overflow-x: hidden;
}

html {
    scroll-behavior: smooth;
}

/* Header & Navigation */
header {
    background: var(--navy);
    color: var(--white);
    padding: 1rem 0;
    position: fixed;
    width: 100%;
    top: 0;
    z-index: 1000;
    box-shadow: 0 2px 10px rgba(0, 0, 0, 0.3);
    transition: all 0.3s ease;
}

header.scrolled {
    padding: 0.5rem 0;
    background: rgba(10, 30, 66, 0.95);
}

nav {
    display: flex;
    justify-content: space-between;
    align-items: center;
    max-width: 1200px;
    margin: 0 auto;
    padding: 0 2rem;
}

.logo {
    display: flex;
    align-items: center;
    gap: 1rem;
    font-size: 1.5rem;
    font-weight: bold;
    cursor: pointer;
}

.logo-placeholder {
    width: 50px;
    height: 50px;
    background: url('/Mbizo High Logo.jpeg');
    background-size: contain;
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 1.5rem;
    transition: transform 0.3s ease;
}

.logo:hover .logo-placeholder {
    transform: rotate(360deg);
}

.nav-links {
    display: flex;
    list-style: none;
    gap: 2rem;
    align-items: center;
}

    /* Hamburger and responsive nav */
    .hamburger {
        display: none;
        background: transparent;
        border: none;
        color: var(--white);
        font-size: 1.4rem;
        padding: 0.5rem;
        cursor: pointer;
    }

    /* Mobile nav when toggled */
    body.nav-open .nav-links {
        position: fixed;
        top: 0;
        right: 0;
        height: 100vh;
        width: 260px;
        background: linear-gradient(180deg, rgba(10,30,66,0.98), rgba(10,30,66,0.98));
        flex-direction: column;
        gap: 1.2rem;
        padding: 4rem 1.5rem;
        box-shadow: -6px 0 30px rgba(0,0,0,0.3);
        transform: translateX(0);
        z-index: 1100;
    }

    body.nav-open .nav-links a {
        color: var(--white);
        font-size: 1.05rem;
        padding: 0.6rem 0.8rem;
        display: block;
    }

.nav-links a {
    color: var(--white);
    text-decoration: none;
    padding: 0.5rem 1rem;
    border-radius: 5px;
    transition: all 0.3s ease;
    position: relative;
}

.nav-links a::after {
    content: '';
    position: absolute;
    bottom: 0;
    left: 50%;
    width: 0;
    height: 2px;
    background: var(--gold);
    transition: all 0.3s ease;
    transform: translateX(-50%);
}

.nav-links a:hover {
    color: var(--gold);
}

.nav-links a:hover::after {
    width: 80%;
}

.back-btn, .logout-btn {
    background: var(--gold);
    color: var(--navy);
    padding: 0.5rem 1.5rem;
    border-radius: 25px;
    font-weight: bold;
    transition: all 0.3s ease;
    cursor: pointer;
    border: none;
}

.back-btn:hover, .logout-btn:hover {
    transform: translateY(-2px);
    box-shadow: 0 5px 15px rgba(212, 175, 55, 0.4);
}

/* Hero Section */
.hero {
    height: 100vh;
    background: linear-gradient(135deg, var(--navy) 0%, #1a3a6b 100%);
    display: flex;
    align-items: center;
    justify-content: center;
    text-align: center;
    color: var(--white);
    position: relative;
    overflow: hidden;
}

.hero::before {
    content: '';
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background: url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1200 600"><path fill="rgba(212,175,55,0.1)" d="M0,300 Q300,150 600,300 T1200,300 L1200,600 L0,600 Z"/></svg>');
    background-size: cover;
    opacity: 0.3;
}

.hero-content {
    position: relative;
    z-index: 1;
    animation: fadeInUp 1s ease;
}

    /* Small utility to ensure nav overlay sits above hero and other elements */
    body.nav-open header { z-index: 1200; }

.hero h1 {
    font-size: 4rem;
    margin-bottom: 1rem;
    text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.5);
}

.hero p {
    font-size: 1.5rem;
    margin-bottom: 2rem;
    opacity: 0.9;
}

.btn {
    display: inline-block;
    padding: 1rem 2.5rem;
    background: var(--gold);
    color: var(--navy);
    text-decoration: none;
    border-radius: 50px;
    font-weight: bold;
    transition: all 0.3s ease;
    border: 2px solid var(--gold);
    cursor: pointer;
    font-size: 1rem;
}

.btn:hover {
    background: transparent;
    color: var(--gold);
    transform: translateY(-3px);
    box-shadow: 0 10px 25px rgba(212, 175, 55, 0.3);
}

.btn:active {
    transform: translateY(-1px);
}

/* Main Content Areas */
.main-view {
    display: block;
}

.app-view {
    display: none;
    min-height: 100vh;
    padding-top: 80px;
}

.app-view.active {
    display: block;
}

section {
    padding: 5rem 2rem;
    max-width: 1200px;
    margin: 0 auto;
}

.section-title {
    text-align: center;
    font-size: 2.5rem;
    margin-bottom: 3rem;
    color: var(--navy);
    position: relative;
    padding-bottom: 1rem;
}

.section-title::after {
    content: '';
    position: absolute;
    bottom: 0;
    left: 50%;
    transform: translateX(-50%);
    width: 80px;
    height: 4px;
    background: var(--gold);
    border-radius: 2px;
}

/* About Section */
.about-content {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 3rem;
    align-items: center;
}

.about-image {
    width: 100%;
    height: 400px;
    background: linear-gradient(135deg, var(--navy), var(--gold));
    border-radius: 15px;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 3rem;
    color: var(--white);
    box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
    transition: transform 0.3s ease;
}

.about-image:hover {
    transform: scale(1.05);
}

.about-text h3 {
    color: var(--navy);
    font-size: 1.8rem;
    margin-bottom: 1rem;
}

.about-text p {
    margin-bottom: 1rem;
    line-height: 1.8;
}

/* Features Grid */
.features-grid {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
    gap: 2rem;
    margin-top: 3rem;
}

.feature-card {
    background: var(--white);
    padding: 2rem;
    border-radius: 15px;
    box-shadow: 0 5px 20px rgba(0, 0, 0, 0.1);
    transition: all 0.3s ease;
    text-align: center;
    cursor: pointer;
}

.feature-card:hover {
    transform: translateY(-10px);
    box-shadow: 0 15px 35px rgba(0, 0, 0, 0.15);
}

.feature-icon {
    width: 80px;
    height: 80px;
    background: var(--gold);
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 2.5rem;
    margin: 0 auto 1.5rem;
    transition: all 0.3s ease;
}

.feature-card:hover .feature-icon {
    transform: rotate(360deg);
    background: var(--navy);
}

.feature-card h3 {
    color: var(--navy);
    margin-bottom: 1rem;
}

/* Notices Section */
#notices {
    background: var(--light-gray);
}

.notices-grid {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
    gap: 2rem;
}

.notice-card {
    background: var(--white);
    padding: 2rem;
    border-radius: 10px;
    box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
    transition: all 0.3s ease;
    border-left: 4px solid var(--gold);
}

.notice-card:hover {
    transform: translateY(-5px);
    box-shadow: 0 10px 25px rgba(0, 0, 0, 0.15);
}

.notice-date {
    color: var(--gold);
    font-weight: bold;
    margin-bottom: 0.5rem;
}

.notice-title {
    color: var(--navy);
    font-size: 1.3rem;
    margin-bottom: 0.5rem;
}

/* Gallery Section */
.gallery-grid {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
    gap: 1.5rem;
}

.gallery-item {
    height: 250px;
    background: linear-gradient(135deg, var(--navy), var(--gold));
    border-radius: 10px;
    overflow: hidden;
    cursor: pointer;
    transition: all 0.3s ease;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 2rem;
    color: var(--white);
}

.gallery-item:hover {
    transform: scale(1.05);
    box-shadow: 0 10px 25px rgba(0, 0, 0, 0.2);
}

/* Contact Section */
#contact {
    background: var(--light-gray);
}

.contact-content {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 3rem;
}

.contact-form {
    background: var(--white);
    padding: 2rem;
    border-radius: 15px;
    box-shadow: 0 5px 20px rgba(0, 0, 0, 0.1);
}

.form-group {
    margin-bottom: 1.5rem;
}

.form-group label {
    display: block;
    margin-bottom: 0.5rem;
    color: var(--navy);
    font-weight: bold;
}

.form-group input,
.form-group textarea,
.form-group select {
    width: 100%;
    padding: 0.8rem;
    border: 2px solid var(--light-gray);
    border-radius: 8px;
    font-family: inherit;
    transition: all 0.3s ease;
}

.form-group input:focus,
.form-group textarea:focus,
.form-group select:focus {
    outline: none;
    border-color: var(--gold);
}

/* Attendance and visual polish for mixed layout */
#classSelect {
    padding: 1rem 1.2rem;
    border-radius: 12px;
    border: 2px solid #e9eef8;
    background: #fff;
    box-shadow: 0 6px 20px rgba(2,10,40,0.04);
    font-weight: 600;
}

.btn.add-student {
    padding: 1rem 2.5rem;
    border-radius: 40px;
    font-size: 1.05rem;
    box-shadow: 0 12px 30px rgba(212,175,55,0.18);
    border: 3px solid rgba(0,0,0,0.06);
}

.student-card { border-radius: 16px; padding: 1.5rem 1.6rem; }
.student-header { align-items: flex-start; }
.student-name { font-size: 1.25rem; }
.attendance-status { padding: 6px 12px; border-radius: 20px; font-weight:700; }
.performance-chart { background: #fbfdff; padding: 1rem; border-radius: 10px; }
.performance-item strong { float: right; color: var(--navy); }
.performance-bar { background: linear-gradient(90deg,var(--gold),#d0a83a); height: 14px; border-radius: 10px; }

.contact-info {
    background: var(--navy);
    color: var(--white);
    padding: 2rem;
    border-radius: 15px;
}

.contact-info h3 {
    color: var(--gold);
    margin-bottom: 1.5rem;
}

.contact-item {
    margin-bottom: 1.5rem;
    display: flex;
    align-items: start;
    gap: 1rem;
}

.contact-icon {
    font-size: 1.5rem;
    color: var(--gold);
}

/* Footer */
footer {
    background: var(--navy);
    color: var(--white);
    text-align: center;
    padding: 2rem;
}

/* App Screens */
.app-header {
    background: var(--white);
    padding: 2rem;
    border-radius: 15px;
    box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
    margin-bottom: 2rem;
}

/* Form section spacing */
.form-section {
    margin-bottom: 2rem;
}

/* Utility classes for common inline styles */
.hidden {
    display: none;
}

.powered-by-text {
    font-size: 1rem;
    margin-top: 1rem;
}

.brand-color {
    color: var(--gold);
}

.features-intro {
    text-align: center;
    color: var(--dark-gray);
    margin-bottom: 2rem;
}

.footer-powered-by {
    margin-top: 0.5rem;
}

.payment-form-hidden {
    display: none;
}

.payment-details-title {
    color: var(--navy);
    margin-bottom: 1.5rem;
}

.char-count {
    color: var(--dark-gray);
}

.section-spacing {
    margin-top: 3rem;
}

.section-title-navy {
    color: var(--navy);
    margin-bottom: 1rem;
}

.calendar-month-title {
    color: var(--navy);
}

.event-form-spacing {
    margin-top: 2rem;
}

.upload-btn-spacing {
    margin-bottom: 2rem;
}

.admin-section-hidden {
    display: none;
}

.text-center {
    text-align: center;
}

.text-center-gray {
    text-align: center;
    color: var(--dark-gray);
}

.app-header h2 {
    color: var(--navy);
    font-size: 2rem;
    margin-bottom: 0.5rem;
}

.app-header p {
    color: var(--dark-gray);
}

/* Attendance Tracker */
.attendance-grid {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
    gap: 2rem;
}

.student-card {
    background: var(--white);
    padding: 1.5rem;
    border-radius: 10px;
    box-shadow: 0 3px 10px rgba(0, 0, 0, 0.1);
    transition: all 0.3s ease;
}

.student-card:hover {
    transform: translateY(-5px);
    box-shadow: 0 8px 20px rgba(0, 0, 0, 0.15);
}

.student-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 1rem;
    padding-bottom: 1rem;
    border-bottom: 2px solid var(--light-gray);
}

.student-name {
    font-weight: bold;
    color: var(--navy);
    font-size: 1.2rem;
}

.attendance-status {
    padding: 0.3rem 1rem;
    border-radius: 20px;
    font-size: 0.85rem;
    font-weight: bold;
}

.status-present {
    background: #d4edda;
    color: #155724;
}

.status-absent {
    background: #f8d7da;
    color: #721c24;
}

.status-late {
    background: #fff3cd;
    color: #856404;
}

.attendance-actions {
    display: flex;
    gap: 0.5rem;
    margin-top: 1rem;
}

.btn-small {
    flex: 1;
    padding: 0.5rem;
    border: none;
    border-radius: 5px;
    cursor: pointer;
    font-weight: bold;
    transition: all 0.3s ease;
}

.btn-success {
    background: var(--success);
    color: white;
}

.btn-danger {
    background: var(--danger);
    color: white;
}

.btn-warning {
    background: #ffc107;
    color: var(--dark-gray);
}

.btn-small:hover {
    transform: translateY(-2px);
    box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
}

.performance-chart {
    margin-top: 1rem;
    padding: 1rem;
    background: var(--light-gray);
    border-radius: 8px;
}

.performance-item {
    display: flex;
    justify-content: space-between;
    margin-bottom: 0.5rem;
}

.performance-bar {
    height: 20px;
    background: var(--gold);
    border-radius: 10px;
    margin-top: 0.5rem;
    transition: width 0.5s ease;
}

/* Add Student Form */
.add-student-form {
    background: var(--white);
    padding: 2rem;
    border-radius: 15px;
    box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
    margin-bottom: 2rem;
}

.add-student-form h3 {
    color: var(--navy);
    margin-bottom: 1.5rem;
}

.form-row {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 1rem;
    margin-bottom: 1rem;
}

/* Payment Integration */
.payment-options {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
    gap: 2rem;
    margin-top: 2rem;
}

.payment-card {
    background: var(--white);
    padding: 2rem;
    border-radius: 15px;
    box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
    text-align: center;
    transition: all 0.3s ease;
    cursor: pointer;
}

.payment-card:hover {
    transform: translateY(-10px);
    box-shadow: 0 15px 30px rgba(0, 0, 0, 0.2);
}

.payment-icon {
    font-size: 3rem;
    margin-bottom: 1rem;
}

.payment-form {
    background: var(--white);
    padding: 2rem;
    border-radius: 15px;
    box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
    max-width: 500px;
    margin: 2rem auto;
}

/* Resources Section */
.resources-filter {
    display: flex;
    gap: 1rem;
    margin-bottom: 2rem;
    flex-wrap: wrap;
}

.filter-btn {
    padding: 0.8rem 1.5rem;
    background: var(--white);
    border: 2px solid var(--navy);
    color: var(--navy);
    border-radius: 25px;
    cursor: pointer;
    transition: all 0.3s ease;
    font-weight: bold;
}

.filter-btn:hover,
.filter-btn.active {
    background: var(--navy);
    color: var(--white);
}

.resources-grid {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
    gap: 2rem;
}

.resource-card {
    background: var(--white);
    padding: 1.5rem;
    border-radius: 10px;
    box-shadow: 0 3px 10px rgba(0, 0, 0, 0.1);
    transition: all 0.3s ease;
}

.resource-card:hover {
    transform: translateY(-5px);
    box-shadow: 0 8px 20px rgba(0, 0, 0, 0.15);
}

.resource-type {
    display: inline-block;
    padding: 0.3rem 0.8rem;
    background: var(--gold);
    color: var(--navy);
    border-radius: 15px;
    font-size: 0.85rem;
    font-weight: bold;
    margin-bottom: 1rem;
}

/* Calendar */
.calendar-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 2rem;
    padding: 1rem;
    background: var(--white);
    border-radius: 10px;
    box-shadow: 0 3px 10px rgba(0, 0, 0, 0.1);
}

.calendar-nav {
    display: flex;
    gap: 1rem;
}

.calendar-grid {
    display: grid;
    grid-template-columns: repeat(7, 1fr);
    gap: 1rem;
}

.calendar-day {
    background: var(--white);
    padding: 1rem;
    border-radius: 8px;
    min-height: 100px;
    box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
    transition: all 0.3s ease;
    cursor: pointer;
}

.calendar-day:hover {
    transform: translateY(-3px);
    box-shadow: 0 5px 15px rgba(0, 0, 0, 0.15);
}

.day-number {
    font-weight: bold;
    color: var(--navy);
    margin-bottom: 0.5rem;
}

.day-event {
    font-size: 0.8rem;
    padding: 0.3rem;
    background: var(--gold);
    color: var(--navy);
    border-radius: 3px;
    margin-top: 0.3rem;
}

/* Portfolios */
.portfolio-filters {
    display: flex;
    gap: 1rem;
    margin-bottom: 2rem;
}

.portfolio-grid {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
    gap: 2rem;
}

.portfolio-card {
    background: var(--white);
    border-radius: 15px;
    overflow: hidden;
    box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
    transition: all 0.3s ease;
}

.portfolio-card:hover {
    transform: translateY(-10px);
    box-shadow: 0 15px 30px rgba(0, 0, 0, 0.2);
}

.portfolio-image {
    height: 200px;
    background: linear-gradient(135deg, var(--navy), var(--gold));
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 3rem;
}

.portfolio-content {
    padding: 1.5rem;
}

.portfolio-author {
    color: var(--gold);
    font-weight: bold;
    margin-bottom: 0.5rem;
}

.portfolio-title {
    color: var(--navy);
    font-size: 1.3rem;
    margin-bottom: 0.5rem;
}

/* Chat Widget */
.chat-widget {
    position: fixed;
    bottom: 2rem;
    right: 2rem;
    z-index: 1500;
}

.chat-button {
    width: 60px;
    height: 60px;
    border-radius: 50%;
    background: linear-gradient(135deg, var(--gold) 0%, var(--navy) 100%);
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 1.8rem;
    cursor: pointer;
    box-shadow: 0 4px 20px rgba(0, 0, 0, 0.3);
    transition: all 0.3s ease;
    border: none;
}

.chat-button:hover {
    transform: scale(1.1);
    box-shadow: 0 6px 30px rgba(212, 175, 55, 0.6);
}

.chat-window {
    display: none;
    position: fixed;
    bottom: 6rem;
    right: 2rem;
    width: 380px;
    height: 550px;
    background: var(--white);
    border-radius: 20px;
    overflow: hidden;
    animation: fadeInUp 0.3s ease;
    box-shadow: 0 10px 40px rgba(0, 0, 0, 0.3);
    flex-direction: column;
}

.chat-window.active {
    display: flex;
}

.chat-header {
    background: linear-gradient(135deg, var(--navy) 0%, #1a3a6b 100%);
    padding: 1.5rem;
    display: flex;
    justify-content: space-between;
    align-items: center;
    color: var(--white);
}

.chat-header h3 {
    font-size: 1.2rem;
}

.close-chat {
    font-size: 1.5rem;
    cursor: pointer;
    transition: transform 0.3s;
}

.close-chat:hover {
    transform: rotate(90deg);
}

.chat-messages {
    flex: 1;
    padding: 1.5rem;
    overflow-y: auto;
    display: flex;
    flex-direction: column;
    gap: 1rem;
    background: var(--light-gray);
}

.message {
    max-width: 80%;
    padding: 0.8rem 1.2rem;
    border-radius: 15px;
    line-height: 1.5;
    animation: fadeIn 0.3s ease;
}

.message.bot {
    background: var(--white);
    border: 1px solid var(--navy);
    align-self: flex-start;
}

.message.user {
    background: var(--navy);
    color: var(--white);
    align-self: flex-end;
}

.chat-input-container {
    padding: 1rem;
    border-top: 1px solid var(--light-gray);
    display: flex;
    gap: 0.5rem;
    background: var(--white);
}

.chat-input {
    flex: 1;
    padding: 0.8rem;
    border: 2px solid var(--light-gray);
    border-radius: 10px;
    font-family: inherit;
}

.chat-input:focus {
    outline: none;
    border-color: var(--gold);
}

.send-btn {
    padding: 0.8rem 1.5rem;
    background: var(--gold);
    color: var(--navy);
    border: none;
    border-radius: 10px;
    cursor: pointer;
    transition: all 0.3s ease;
    font-weight: bold;
}

.send-btn:hover {
    transform: scale(1.05);
    box-shadow: 0 5px 15px rgba(212, 175, 55, 0.4);
}

/* Modal */
.modal {
    display: none;
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: rgba(0, 0, 0, 0.8);
    z-index: 2000;
    justify-content: center;
    align-items: center;
    animation: fadeIn 0.3s ease;
}

.modal.active {
    display: flex;
}

.modal-content {
    background: var(--white);
    padding: 2rem;
    border-radius: 15px;
    max-width: 600px;
    width: 90%;
    max-height: 90vh;
    overflow-y: auto;
    animation: slideUp 0.3s ease;
}

/* Animations */
@keyframes fadeIn {
    from { opacity: 0; }
    to { opacity: 1; }
}

@keyframes fadeInUp {
    from {
        opacity: 0;
        transform: translateY(30px);
    }
    to {
        opacity: 1;
        transform: translateY(0);
    }
}

@keyframes slideUp {
    from {
        opacity: 0;
        transform: translateY(50px);
    }
    to {
        opacity: 1;
        transform: translateY(0);
    }
}

.fade-in {
    opacity: 0;
    transform: translateY(30px);
    transition: all 0.6s ease;
}

.fade-in.visible {
    opacity: 1;
    transform: translateY(0);
}

.spinner {
    border: 3px solid var(--light-gray);
    border-top: 3px solid var(--gold);
    border-radius: 50%;
    width: 40px;
    height: 40px;
    animation: spin 1s linear infinite;
    margin: 2rem auto;
}

@keyframes spin {
    0% { transform: rotate(0deg); }
    100% { transform: rotate(360deg); }
}

/* Admin Panel */
.admin-btn {
    position: fixed;
    bottom: 2rem;
    left: 2rem;
    width: 60px;
    height: 60px;
    background: var(--gold);
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 1.5rem;
    cursor: pointer;
    box-shadow: 0 5px 20px rgba(0, 0, 0, 0.3);
    transition: all 0.3s ease;
    z-index: 999;
}

/* Utility Classes */
.loading {
    text-align: center;
    padding: 2rem;
    color: var(--dark-gray);
}

.error-message {
    background: #f8d7da;
    color: #721c24;
    padding: 1rem;
    border-radius: 5px;
    margin-bottom: 1rem;
}

.success-message {
    background: #d4edda;
    color: #155724;
    padding: 0.8rem;
    border-radius: 5px;
    margin-bottom: 1rem;
    display: none;
}

/* Responsive Design */
@media (max-width: 768px) {
    .hamburger { display: inline-flex; align-items:center; justify-content:center; }
    .nav-links { display: none; }
    body.nav-open .nav-links { display: flex; }

    .about-content,
    .contact-content {
        grid-template-columns: 1fr;
    }
    
    .features-grid,
    .notices-grid,
    .gallery-grid,
    .resources-grid,
    .portfolio-grid {
        grid-template-columns: 1fr;
    }
    
    .hero h1 {
        font-size: 2.5rem;
    }
    
    .hero p {
        font-size: 1.2rem;
    }
    
    .nav-links {
        flex-direction: column;
        gap: 1rem;
    }
    
    .form-row {
        grid-template-columns: 1fr;
    }
    
    .chat-window {
        width: 90vw;
        right: 5vw;
    }
}
    </style>
        
</head>
<body>
    <!-- Header -->
    <header id="header">
        <nav>
            <div class="logo" onclick="showMainView()" role="button" tabindex="0" aria-label="Go to main page" title="Click to return to main page">
                <div class="logo-placeholder"></div>
                <span>Mbizo High School</span>
            </div>
                <button class="hamburger" aria-label="Toggle navigation" aria-expanded="false" onclick="toggleNav()">‚ò∞</button>
            <ul class="nav-links">
                <li><a href="#home">Home</a></li>
                <li><a href="#about">About</a></li>
                <li><a href="#features">Features</a></li>
                <li><a href="#notices">Notices</a></li>
                <li><a href="#gallery">Gallery</a></li>
                <li><a href="#contact">Contact</a></li>
                <li><a href="login.html" class="back-btn">üîê Login</a></li>
                <li><a href="#" class="back-btn hidden" onclick="showMainView()" id="backBtn">‚Üê Back</a></li>
            </ul>
        </nav>
    </header>

    <!-- Main View -->
    <div id="mainView" class="main-view">
        <!-- Hero Section -->
        <section id="home" class="hero">
            <div class="hero-content">
                <h1>Welcome to Mbizo High School</h1>
                <p>Excellence in Education, Character in Action</p>
                <p class="powered-by-text">Powered by <strong class="brand-color">ModernizeFlow</strong></p>
                <a href="#features" class="btn">Explore Smart Features</a>
            </div>
        </section>

        <!-- About Section -->
        <section id="about" class="fade-in">
            <h2 class="section-title">About Us</h2>
            <div class="about-content">
                <div class="about-image">üéì</div>
                <div class="about-text">
                    <h3>Building Tomorrow's Leaders</h3>
                    <p>Mbizo High School has been a cornerstone of quality education in our community for over three decades. We are committed to nurturing young minds, fostering academic excellence, and developing well-rounded individuals prepared for the challenges of tomorrow.</p>
                    <p>Our dedicated staff, modern facilities, and comprehensive curriculum ensure that every student receives the best possible education in a supportive and inspiring environment.</p>
                    <p>We pride ourselves on our strong academic performance, vibrant extracurricular activities, and the positive values we instill in our students.</p>
                </div>
            </div>
        </section>

        <!-- Features Section -->
        <section id="features" class="fade-in">
            <h2 class="section-title">Smart Digital Features</h2>
            <p class="features-intro">Click on any feature to access the full system</p>
            <div class="features-grid">
                <div class="feature-card" onclick="showApp('attendance')" role="button" tabindex="0" aria-label="Open Attendance Tracker" title="Click to access attendance tracking system">
                    <div class="feature-icon">üìä</div>
                    <h3>Attendance Tracker</h3>
                    <p>Digital attendance logging with real-time performance tracking and automated reports.</p>
                </div>
                <div class="feature-card" onclick="showApp('payment')" role="button" tabindex="0" aria-label="Open EcoCash Payments" title="Click to access payment system">
                    <div class="feature-icon">üí∞</div>
                    <h3>EcoCash Payments</h3>
                    <p>Pay school fees, event fees seamlessly through EcoCash mobile money.</p>
                </div>
                <div class="feature-card" onclick="showApp('sms')" role="button" tabindex="0" aria-label="Open SMS Notifications" title="Click to access SMS notification system">
                    <div class="feature-icon">üì±</div>
                    <h3>SMS Notifications</h3>
                    <p>Automated reminders for fees, events, exam results, and announcements.</p>
                </div>
                <div class="feature-card" onclick="showApp('resources')" role="button" tabindex="0" aria-label="Open ZIMSEC Resources" title="Click to access educational resources">
                    <div class="feature-icon">üìö</div>
                    <h3>ZIMSEC Resources</h3>
                    <p>Access past exam papers, revision materials, and study guides.</p>
                </div>
                <div class="feature-card" onclick="showApp('calendar')" role="button" tabindex="0" aria-label="Open School Calendar" title="Click to access school calendar">
                    <div class="feature-icon">üìÖ</div>
                    <h3>School Calendar</h3>
                    <p>Interactive calendar with events, holidays. Sync to Google Calendar.</p>
                </div>
                <div class="feature-card" onclick="showApp('portfolios')" role="button" tabindex="0" aria-label="Open Student Portfolios" title="Click to access student portfolios">
                    <div class="feature-icon">üèÜ</div>
                    <h3>Student Portfolios</h3>
                    <p>Showcase student projects, achievements, and creative works.</p>
                </div>
            </div>
        </section>

        <!-- Notices Section -->
        <section id="notices" class="fade-in">
            <h2 class="section-title">School Notices</h2>
            <div class="notices-grid" id="noticesContainer" role="region" aria-label="School notices">
                <div class="spinner"></div>
            </div>
        </section>

        <!-- Gallery Section -->
        <section id="gallery" class="fade-in">
            <h2 class="section-title">School Gallery</h2>
            <div class="gallery-grid" role="region" aria-label="School gallery">
                <div class="gallery-item"><img src="/image.png" onerror="this.onerror=null;this.src='Mbizo High Logo.jpeg'" alt="Gallery image 1" style="width:100%;height:100%;object-fit:cover;border-radius:10px"></div>
                <div class="gallery-item"><img src="/image.png" onerror="this.onerror=null;this.src='Mbizo High Logo.jpeg'" alt="Gallery image 2" style="width:100%;height:100%;object-fit:cover;border-radius:10px"></div>
                <div class="gallery-item"><img src="/image.png" onerror="this.onerror=null;this.src='Mbizo High Logo.jpeg'" alt="Gallery image 3" style="width:100%;height:100%;object-fit:cover;border-radius:10px"></div>
                <div class="gallery-item"><img src="/image.png" onerror="this.onerror=null;this.src='Mbizo High Logo.jpeg'" alt="Gallery image 4" style="width:100%;height:100%;object-fit:cover;border-radius:10px"></div>
                <div class="gallery-item"><img src="/image.png" onerror="this.onerror=null;this.src='Mbizo High Logo.jpeg'" alt="Gallery image 5" style="width:100%;height:100%;object-fit:cover;border-radius:10px"></div>
                <div class="gallery-item"><img src="/image.png" onerror="this.onerror=null;this.src='Mbizo High Logo.jpeg'" alt="Gallery image 6" style="width:100%;height:100%;object-fit:cover;border-radius:10px"></div>
                <div class="gallery-item"><img src="/image.png" onerror="this.onerror=null;this.src='Mbizo High Logo.jpeg'" alt="Gallery image 7" style="width:100%;height:100%;object-fit:cover;border-radius:10px"></div>
                <div class="gallery-item"><img src="/image.png" onerror="this.onerror=null;this.src='Mbizo High Logo.jpeg'" alt="Gallery image 8" style="width:100%;height:100%;object-fit:cover;border-radius:10px"></div>
            </div>
        </section>

        <!-- Contact Section -->
        <section id="contact" class="fade-in">
            <h2 class="section-title">Contact Us</h2>
            <div class="contact-content">
                <form class="contact-form" id="contactForm" role="form" aria-label="Contact form">
                    <div class="form-group">
                        <label for="name">Full Name</label>
                        <input type="text" id="name" name="name" required title="Enter your full name" aria-label="Full Name">
                    </div>
                    <div class="form-group">
                        <label for="email">Email Address</label>
                        <input type="email" id="email" name="email" required title="Enter your email address" aria-label="Email Address">
                    </div>
                    <div class="form-group">
                        <label for="message">Message</label>
                        <textarea id="message" name="message" rows="5" required title="Enter your message" aria-label="Message"></textarea>
                    </div>
                    <button type="submit" class="btn" aria-label="Send contact message" title="Submit contact form">Send Message</button>
                </form>
                <div class="contact-info">
                    <h3>Get In Touch</h3>
                    <div class="contact-item">
                        <div class="contact-icon">üìç</div>
                        <div>
                            <strong>Address:</strong><br>
                            3VW5+WJF, Mbizo<br>
                            Kwekwe, Zimbabwe
                        </div>
                    </div>
                    <div class="contact-item">
                        <div class="contact-icon">üìû</div>
                        <div>
                            <strong>Phone:</strong><br>
                            +263 40067
                        </div>
                    </div>
                    <div class="contact-item">
                        <div class="contact-icon">üìß</div>
                        <div>
                            <strong>Email:</strong><br>
                            info@mbizohigh.ac.zw
                        </div>
                    </div>
                    <div class="contact-item">
                        <div class="contact-icon">‚è∞</div>
                        <div>
                            <strong>Office Hours:</strong><br>
                            Monday - Friday: 7:30 AM - 4:00 PM
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- Footer -->
        <footer>
            <p>&copy; 2025 Mbizo High School. All rights reserved.</p>
            <p class="footer-powered-by">Powered by <strong class="brand-color">ModernizeFlow</strong> - Modernizing Education</p>
        </footer>
    </div>

    <!-- Attendance Tracker App -->
    <div id="attendanceApp" class="app-view">
        <section>
            <div class="app-header">
                <h2>üìä Attendance & Performance Tracker</h2>
                <p>Track student attendance and academic performance in real-time</p>
            </div>

            <div class="form-section">
                <div class="form-group">
                    <label for="classSelect">Select Class</label>
                    <select id="classSelect" onchange="loadStudents()" title="Select a class to view students" aria-label="Select Class">
                        <option value="form1a">Form 1A</option>
                        <option value="form1b">Form 1B</option>
                        <option value="form1c">Form 1C</option>
                        <option value="form1d">Form 1D</option>
                        <option value="form1e">Form 1E</option>
                        <option value="form1f">Form 1F</option>
                        <option value="form1g">Form 1G</option>
                        <option value="form1h">Form 1H</option>
                        <option value="form1i">Form 1I</option>
                        <option value="form1j">Form 1J</option>
                        <option value="form2a">Form 2A</option>
                        <option value="form2b">Form 2B</option>
                        <option value="form2c">Form 2C</option>
                        <option value="form2d">Form 2D</option>
                        <option value="form2e">Form 2E</option>
                        <option value="form2f">Form 2F</option>
                        <option value="form2g">Form 2G</option>
                        <option value="form2h">Form 2H</option>
                        <option value="form2i">Form 2I</option>
                        <option value="form2j">Form 2J</option>
                        <option value="form3a">Form 3A</option>
                        <option value="form3b">Form 3B</option>
                        <option value="form3c">Form 3C</option>
                        <option value="form3d">Form 3D</option>
                        <option value="form3e">Form 3E</option>
                        <option value="form3f">Form 3F</option>
                        <option value="form3g">Form 3G</option>
                        <option value="form3h">Form 3H</option>
                        <option value="form3i">Form 3I</option>
                        <option value="form3j">Form 3J</option>
                        <option value="form4a">Form 4A</option>
                        <option value="form4b">Form 4B</option>
                        <option value="form4c">Form 4C</option>
                        <option value="form4d">Form 4D</option>
                        <option value="form4e">Form 4E</option>
                        <option value="form4f">Form 4F</option>
                        <option value="form4g">Form 4G</option>
                        <option value="form4h">Form 4H</option>
                        <option value="form4i">Form 4I</option>
                        <option value="form4j">Form 4J</option>
                        <option value="l6">Lower 6</option>
                        <option value="u6">Upper 6</option>
                    </select>
                </div>
            </div>

            <div class="attendance-grid" id="studentsContainer" role="region" aria-label="Student attendance list">
                <!-- Students will be loaded here -->
            </div>

            <div class="form-section">
                <h3>Add New Student</h3>
                <div class="form-group">
                    <label for="newStudentName">Student Name</label>
                    <input type="text" id="newStudentName" placeholder="Enter student name">
                </div>
                <button class="btn add-student" onclick="addStudent()">Add Student</button>
            </div>
        </section>
    </div>

    <!-- Payment App -->
    <div id="paymentApp" class="app-view">
        <section>
            <div class="app-header">
                <h2>üí∞ School Fee Payments</h2>
                <p>Pay school fees securely using EcoCash or other methods</p>
            </div>

            <div class="payment-options" role="group" aria-label="Payment method options">
                <div class="payment-card" onclick="selectPayment('ecocash')" role="button" tabindex="0" aria-label="Select EcoCash payment method" title="Choose EcoCash for payment">
                    <div class="payment-icon">üì±</div>
                    <h3>EcoCash</h3>
                    <p>Pay via mobile money</p>
                </div>
                <div class="payment-card" onclick="selectPayment('onemoney')" role="button" tabindex="0" aria-label="Select OneMoney payment method" title="Choose OneMoney for payment">
                    <div class="payment-icon">üí∞</div>
                    <h3>OneMoney</h3>
                    <p>NetOne payment</p>
                </div>
                <div class="payment-card" onclick="selectPayment('bank')" role="button" tabindex="0" aria-label="Select Bank Transfer payment method" title="Choose Bank Transfer for payment">
                    <div class="payment-icon">üè¶</div>
                    <h3>Bank Transfer</h3>
                    <p>Direct bank payment</p>
                </div>
            </div>

            <div class="payment-form payment-form-hidden" id="paymentFormContainer">
                <h3 class="payment-details-title">Payment Details</h3>
                <div class="form-group">
                    <label for="studentName">Student Name</label>
                    <input type="text" id="studentName" placeholder="Enter student name" title="Enter student name" aria-label="Student Name">
                </div>
                <div class="form-group">
                    <label for="studentId">Student ID</label>
                    <input type="text" id="studentId" placeholder="Enter student ID" title="Enter student ID" aria-label="Student ID">
                </div>
                <div class="form-group">
                    <label for="paymentType">Payment Type</label>
                    <select id="paymentType" title="Select the type of payment" aria-label="Payment Type">
                        <option value="tuition">Tuition Fees</option>
                        <option value="exam">Examination Fees</option>
                        <option value="sports">Sports Day</option>
                        <option value="trip">School Trip</option>
                        <option value="other">Other</option>
                    </select>
                </div>
                <div class="form-group">
                    <label for="paymentAmount">Amount (USD)</label>
                    <input type="number" id="paymentAmount" placeholder="Enter amount" title="Enter payment amount in USD" aria-label="Payment Amount">
                </div>
                <div class="form-group">
                    <label for="paymentPhone">Phone Number</label>
                    <input type="tel" id="paymentPhone" placeholder="+263 77 123 4567" title="Enter phone number for payment" aria-label="Phone Number">
                </div>
                <button class="btn" onclick="processPayment()" aria-label="Process payment transaction" title="Submit payment details">Process Payment</button>
            </div>
        </section>
    </div>

    <!-- SMS Notifications App -->
    <div id="smsApp" class="app-view">
        <section>
            <div class="app-header">
                <h2>üì± SMS Notification System</h2>
                <p>Send automated notifications to parents and students</p>
            </div>

            <div class="payment-form">
                <div class="form-group">
                    <label for="smsRecipient">Recipient Group</label>
                    <select id="smsRecipient" title="Select recipient group for SMS" aria-label="SMS Recipient Group">
                        <option value="all">All Parents</option>
                        <option value="form1">Form 1 Parents</option>
                        <option value="form2">Form 2 Parents</option>
                        <option value="form3">Form 3 Parents</option>
                        <option value="form4">Form 4 Parents</option>
                        <option value="custom">Custom Numbers</option>
                    </select>
                </div>
                <div class="form-group">
                    <label for="smsType">Message Type</label>
                    <select id="smsType" title="Select message type" aria-label="SMS Message Type">
                        <option value="fees">Fee Reminder</option>
                        <option value="exam">Exam Notification</option>
                        <option value="event">Event Announcement</option>
                        <option value="attendance">Attendance Alert</option>
                        <option value="results">Results Available</option>
                        <option value="custom">Custom Message</option>
                    </select>
                </div>
                <div class="form-group">
                    <label for="smsMessage">Message</label>
                    <textarea id="smsMessage" rows="5" placeholder="Enter your message here..." title="Enter SMS message content" aria-label="SMS Message"></textarea>
                    <small class="char-count">Characters: <span id="charCount">0</span>/160</small>
                </div>
                <button class="btn" onclick="sendSMS()" aria-label="Send SMS message" title="Send SMS to selected recipients">Send SMS</button>
            </div>

            <div class="section-spacing">
                <h3 class="section-title-navy">Recent Messages</h3>
                <div id="smsHistory" role="region" aria-label="SMS message history"></div>
            </div>
        </section>
    </div>

    <!-- Resources App -->
    <div id="resourcesApp" class="app-view">
        <section>
            <div class="app-header">
                <h2>üìö ZIMSEC Resources</h2>
                <p>Access past papers, study guides, and revision materials</p>
            </div>

            <div class="resources-filter" role="group" aria-label="Resource filter options">
                <button class="filter-btn active" onclick="filterResources('all')" aria-label="Show all resources" title="Display all available resources">All</button>
                <button class="filter-btn" onclick="filterResources('olevel')" aria-label="Show O-Level resources" title="Display O-Level resources only">O-Level</button>
                <button class="filter-btn" onclick="filterResources('alevel')" aria-label="Show A-Level resources" title="Display A-Level resources only">A-Level</button>
                <button class="filter-btn" onclick="filterResources('notes')" aria-label="Show study notes" title="Display study notes only">Notes</button>
                <button class="filter-btn" onclick="filterResources('papers')" aria-label="Show past papers" title="Display past papers only">Past Papers</button>
            </div>

            <div class="resources-grid" id="resourcesContainer" role="region" aria-label="Educational resources">
                <!-- Resources will be loaded here -->
            </div>
        </section>
    </div>

    <!-- Calendar App -->
    <div id="calendarApp" class="app-view">
        <section>
            <div class="app-header">
                <h2>üìÖ School Calendar</h2>
                <p>View upcoming events, holidays, and important dates</p>
            </div>

            <div class="calendar-header">
                <button class="btn" onclick="previousMonth()" aria-label="Go to previous month" title="Navigate to previous month">‚Üê Previous</button>
                <h3 id="currentMonth" class="calendar-month-title"></h3>
                <button class="btn" onclick="nextMonth()" aria-label="Go to next month" title="Navigate to next month">Next ‚Üí</button>
            </div>

            <div class="calendar-grid" id="calendarGrid" role="grid" aria-label="School calendar">

                <!-- Calendar will be generated here -->
            </div>

            <div class="event-form-spacing">
                <h3 class="section-title-navy">Add New Event</h3>
                <div class="payment-form">
                    <div class="form-group">
                        <label for="eventTitle">Event Title</label>
                        <input type="text" id="eventTitle" placeholder="Enter event name" title="Enter event title" aria-label="Event Title">
                    </div>
                    <div class="form-group">
                        <label for="eventDate">Event Date</label>
                        <input type="date" id="eventDate" title="Select event date" aria-label="Event Date">
                    </div>
                    <div class="form-group">
                        <label for="eventType">Event Type</label>
                        <select id="eventType" title="Select event type" aria-label="Event Type">
                            <option value="exam">Examination</option>
                            <option value="holiday">Holiday</option>
                            <option value="sports">Sports Event</option>
                            <option value="meeting">Parent Meeting</option>
                            <option value="other">Other</option>
                        </select>
                    </div>
                    <button class="btn" onclick="addEvent()" aria-label="Add new event to calendar" title="Submit event details">Add Event</button>
                </div>
            </div>
        </section>
    </div>

    <!-- Portfolios App -->
    <div id="portfoliosApp" class="app-view">
        <section>
            <div class="app-header">
                <h2>üèÜ Student & Teacher Portfolios</h2>
                <p>Showcase achievements, projects, and outstanding work</p>
            </div>

            <div class="portfolio-filters" role="group" aria-label="Portfolio filter options">
                <button class="filter-btn active" onclick="filterPortfolios('all')" aria-label="Show all portfolios" title="Display all portfolios">All</button>
                <button class="filter-btn" onclick="filterPortfolios('students')" aria-label="Show student portfolios" title="Display student portfolios only">Students</button>
                <button class="filter-btn" onclick="filterPortfolios('teachers')" aria-label="Show teacher portfolios" title="Display teacher portfolios only">Teachers</button>
            </div>

            <button class="btn upload-btn-spacing" onclick="openUploadModal()" aria-label="Upload new portfolio work" title="Open upload form for portfolio work">+ Upload Work</button>

            <div class="portfolio-grid" id="portfolioContainer" role="region" aria-label="Student and teacher portfolios">
                <!-- Portfolios will be loaded here -->
            </div>
        </section>
    </div>

    <!-- AI Chat Assistant -->
    <div class="chat-widget">
        <button class="chat-button" onclick="toggleChat()" aria-label="Open AI chat assistant" title="Click to chat with AI assistant">ü§ñ</button>
        <div class="chat-window" id="chatWindow">
            <div class="chat-header">
                <h3>AI School Assistant</h3>
                <span class="close-chat" onclick="toggleChat()" role="button" tabindex="0" aria-label="Close chat window" title="Close AI chat assistant">√ó</span>
            </div>
            <div class="chat-messages" id="chatMessages" role="log" aria-label="Chat conversation" aria-live="polite">
                <div class="message bot">
                    üëã Hello! I'm your Mbizo High School AI assistant. I can help you with:
                    <br>‚Ä¢ Fee payments
                    <br>‚Ä¢ Exam schedules
                    <br>‚Ä¢ School events
                    <br>‚Ä¢ Resources
                    <br>‚Ä¢ General inquiries
                    <br><br>How can I assist you today?
                </div>
            </div>
            <div class="chat-input-container">
                <input type="text" class="chat-input" id="chatInput" placeholder="Ask me anything..." onkeypress="handleChatEnter(event)" title="Type your message to the AI assistant" aria-label="Chat Message Input">
                <button class="send-btn" onclick="sendChatMessage()" aria-label="Send chat message" title="Send message to AI assistant">Send</button>
            </div>
        </div>
    </div>

    <!-- Admin Button -->
    <div class="admin-btn" onclick="openAdminPanel()" role="button" tabindex="0" aria-label="Open admin panel" title="Click to access admin panel">üîê</div>

    <!-- Admin Modal -->
    <div class="modal" id="adminModal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>Admin Panel</h2>
                <span class="close-modal" onclick="closeAdminPanel()" role="button" tabindex="0" aria-label="Close admin panel" title="Close admin panel">√ó</span>
            </div>
            <div id="loginSection">
                <div class="form-group">
                    <label for="adminPassword">Enter Admin Password</label>
                    <input type="password" id="adminPassword" placeholder="Enter password" title="Enter admin password" aria-label="Admin Password">
                </div>
                <button class="btn" onclick="verifyAdmin()" aria-label="Login to admin panel" title="Submit admin password">Login</button>
            </div>
            <div id="adminSection" class="admin-section-hidden">
                <h3 class="section-title-navy">Add New Notice</h3>
                <div class="form-group">
                    <label for="noticeTitle">Notice Title</label>
                    <input type="text" id="noticeTitle" placeholder="Enter notice title" title="Enter notice title" aria-label="Notice Title">
                </div>
                <div class="form-group">
                    <label for="noticeContent">Notice Content</label>
                    <textarea id="noticeContent" rows="4" placeholder="Enter notice details" title="Enter notice content" aria-label="Notice Content"></textarea>
                </div>
                <button class="btn" onclick="addNotice()" aria-label="Publish new notice" title="Submit and publish notice">Publish Notice</button>
            </div>
        </div>
    </div>

    <!-- Upload Modal -->
    <div class="modal" id="uploadModal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>Upload Portfolio Work</h2>
                <span class="close-modal" onclick="closeUploadModal()" role="button" tabindex="0" aria-label="Close upload modal" title="Close upload form">√ó</span>
            </div>
            <div class="form-group">
                <label for="authorType">Author Type</label>
                <select id="authorType" title="Select author type" aria-label="Author Type">
                    <option value="student">Student</option>
                    <option value="teacher">Teacher</option>
                </select>
            </div>
            <div class="form-group">
                <label for="authorName">Author Name</label>
                <input type="text" id="authorName" placeholder="Enter name" title="Enter author name" aria-label="Author Name">
            </div>
            <div class="form-group">
                <label for="workTitle">Work Title</label>
                <input type="text" id="workTitle" placeholder="Enter title" title="Enter work title" aria-label="Work Title">
            </div>
            <div class="form-group">
                <label for="workDescription">Description</label>
                <textarea id="workDescription" rows="3" placeholder="Describe the work" title="Describe the work" aria-label="Work Description"></textarea>
            </div>
            <div class="form-group">
                <label for="workCategory">Category</label>
                <select id="workCategory" title="Select work category" aria-label="Work Category">
                    <option value="project">Project</option>
                    <option value="art">Art</option>
                    <option value="essay">Essay</option>
                    <option value="research">Research</option>
                    <option value="achievement">Achievement</option>
                </select>
            </div>
            <button class="btn" onclick="uploadWork()" aria-label="Upload portfolio work" title="Submit portfolio work">Upload</button>
        </div>
    </div>

    <script>
        // Storage key for persistent data
        const STORAGE_KEY = 'mbizo-school-data';

        // Initialize data structure
        let schoolData = {
            notices: [],
            students: {},
            payments: [],
            smsHistory: [],
            resources: [],
            events: [],
            portfolios: []
        };

        // Initialize with sample data
        function initializeData() {
            // Sample students for each class
            const classes = [
                'form1a', 'form1b', 'form1c', 'form1d', 'form1e', 'form1f', 'form1g', 'form1h', 'form1i', 'form1j',
                'form2a', 'form2b', 'form2c', 'form2d', 'form2e', 'form2f', 'form2g', 'form2h', 'form2i', 'form2j',
                'form3a', 'form3b', 'form3c', 'form3d', 'form3e', 'form3f', 'form3g', 'form3h', 'form3i', 'form3j',
                'form4a', 'form4b', 'form4c', 'form4d', 'form4e', 'form4f', 'form4g', 'form4h', 'form4i', 'form4j',
                'l6', 'u6'
            ];
            const sampleNames = [
                'Tafadzwa Moyo', 'Rutendo Ncube', 'Tinashe Dube', 'Chipo Mlambo',
                'Farai Sibanda', 'Rumbi Chikwava', 'Munyaradzi Zvobgo', 'Tendai Mutasa',
                'Ngoni Maposa', 'Chiedza Khumalo', 'Tatenda Chimedza', 'Nyasha Gumbo',
                'Blessing Ndlovu', 'Precious Sithole', 'Innocent Banda', 'Fortune Mhlanga',
                'Simbarashe Chitiyo', 'Tariro Mangena', 'Washington Madziva', 'Ephraim Chawira',
                'Kudakwashe Marufu', 'Ruvimbo Mupfumi', 'Tawanda Gono', 'Mildred Chivasa',
                'Edmore Dube', 'Nomsa Nkomo', 'Jabulani Nkala', 'Thandiwe Mpofu'
            ];

            classes.forEach(cls => {
                schoolData.students[cls] = sampleNames.map((name, idx) => ({
                    id: `${cls}-${idx}`,
                    name: name,
                    status: 'present',
                    attendance: Math.floor(Math.random() * 20) + 80, // 80-100%
                    performance: Math.floor(Math.random() * 30) + 70 // 70-100%
                }));
            });

            // Sample notices
            schoolData.notices = [
                {
                    id: '1',
                    title: 'Term 1 Opening',
                    content: 'School opens on January 9th, 2025. All students report by 8:00 AM.',
                    date: '2025-01-02',
                    timestamp: Date.now()
                },
                {
                    id: '2',
                    title: 'Exam Timetable',
                    content: 'Mid-Term examination timetable now available. Check with class teacher.',
                    date: '2025-01-05',
                    timestamp: Date.now() - 86400000
                }
            ];

            // Sample resources
            schoolData.resources = [
                {
                    id: '1',
                    title: 'Mathematics O-Level 2024',
                    type: 'Past Paper',
                    category: 'olevel',
                    subject: 'Mathematics',
                    year: 2024
                },
                {
                    id: '2',
                    title: 'English Paper 1 Notes',
                    type: 'Study Notes',
                    category: 'notes',
                    subject: 'English',
                    year: 2025
                },
                {
                    id: '3',
                    title: 'Chemistry A-Level 2023',
                    type: 'Past Paper',
                    category: 'alevel',
                    subject: 'Chemistry',
                    year: 2023
                }
            ];

            // Sample portfolios
            schoolData.portfolios = [
                {
                    id: '1',
                    author: 'Tafadzwa Moyo',
                    authorType: 'student',
                    title: 'Science Fair Project',
                    description: 'Solar-powered water purification system',
                    category: 'project'
                },
                {
                    id: '2',
                    author: 'Mrs. Chikwava',
                    authorType: 'teacher',
                    title: 'Mathematics Revision Guide',
                    description: 'Comprehensive guide for Form 4 students',
                    category: 'achievement'
                }
            ];

            saveData();
        }

        // Storage functions - Updated to use backend API
        async function saveData() {
            // Persist local fallback data to localStorage so attendance and added students remain after reload
            try {
                localStorage.setItem(STORAGE_KEY, JSON.stringify(schoolData));
                console.log('Local schoolData saved to localStorage');
            } catch (err) {
                console.error('Error saving local data:', err);
            }
        }

        async function loadData() {
            const token = localStorage.getItem('token');
            // If user is authenticated, prefer backend data
            if (token) {
                try {
                    // Load notices from backend
                    const noticesResp = await fetch('/api/notices');
                    if (noticesResp.ok) {
                        schoolData.notices = await noticesResp.json();
                    }
                    // Load students is done per-class in loadStudents when opening attendance
                    // We still fall through to render notices
                    loadNotices();
                    return;
                } catch (err) {
                    console.error('Error loading backend data while authenticated:', err);
                }
            }

            // Not authenticated or backend failed: use persisted local data if available
            try {
                const raw = localStorage.getItem(STORAGE_KEY);
                if (raw) {
                    const parsed = JSON.parse(raw);
                    schoolData = Object.assign(schoolData, parsed);
                    loadNotices();
                    return;
                }
            } catch (err) {
                console.error('Error reading local storage:', err);
            }

            // No local data ‚Äî initialize sample data and persist it
            initializeData();
            await saveData();
        }

        // Navigation functions
        function showApp(appName) {
            document.getElementById('mainView').style.display = 'none';
            document.querySelectorAll('.app-view').forEach(view => {
                view.classList.remove('active');
            });
            
            const appMap = {
                'attendance': 'attendanceApp',
                'payment': 'paymentApp',
                'sms': 'smsApp',
                'resources': 'resourcesApp',
                'calendar': 'calendarApp',
                'portfolios': 'portfoliosApp'
            };
            
            document.getElementById(appMap[appName]).classList.add('active');
            document.getElementById('backBtn').style.display = 'block';
            
            // Load app-specific data
            if (appName === 'attendance') loadStudents();
            if (appName === 'resources') loadResources();
            if (appName === 'calendar') loadCalendar();
            if (appName === 'portfolios') loadPortfolios();
            if (appName === 'sms') loadSMSHistory();
            
            window.scrollTo(0, 0);
        }

        function showMainView() {
            document.getElementById('mainView').style.display = 'block';
            document.querySelectorAll('.app-view').forEach(view => {
                view.classList.remove('active');
            });
            document.getElementById('backBtn').style.display = 'none';
            window.scrollTo(0, 0);
        }

        // Responsive nav toggle
        function toggleNav() {
            const isOpen = document.body.classList.toggle('nav-open');
            const btn = document.querySelector('.hamburger');
            if (btn) btn.setAttribute('aria-expanded', isOpen ? 'true' : 'false');
        }

        function closeNav() {
            document.body.classList.remove('nav-open');
            const btn = document.querySelector('.hamburger');
            if (btn) btn.setAttribute('aria-expanded', 'false');
        }

        // Close nav when a nav link is clicked (mobile)
        document.addEventListener('DOMContentLoaded', function() {
            document.querySelectorAll('.nav-links a').forEach(a => {
                a.addEventListener('click', function() {
                    closeNav();
                });
            });
            // Close nav on Escape key
            document.addEventListener('keydown', function(e) {
                if (e.key === 'Escape') closeNav();
            });
            // Close nav when window is resized to larger screens
            window.addEventListener('resize', function() {
                if (window.innerWidth > 768) closeNav();
            });
        });

    // Attendance functions
        // Helper: render a student card (used for API and local fallback)
        function renderStudentCard(student, classSelect) {
            const id = student._id || student.id || (student.studentId ? student.studentId : ('s-' + Math.random().toString(36).substr(2,6)));
            const status = student.status || 'present';
            const attendance = (typeof student.attendance === 'number') ? student.attendance : 0;
            const performance = (typeof student.performance === 'number') ? student.performance : 0;
            const initials = (student.name || '').split(' ').map(n=>n[0]).join('').substring(0,2).toUpperCase();
            const classLabel = student.class || classSelect || '';

            return `
                <div class="student-card" role="article" aria-label="Student ${student.name}">
                    <div class="student-header">
                        <div style="display:flex;align-items:center;gap:12px;">
                            <div style="width:54px;height:54px;border-radius:50%;background:linear-gradient(135deg,var(--navy),var(--gold));display:flex;align-items:center;justify-content:center;color:var(--white);font-weight:700;font-size:1rem;">${initials}</div>
                            <div>
                                <div class="student-name">${student.name}</div>
                                <div style="font-size:0.85rem;color:#6b6b6b">${id} ‚Ä¢ ${classLabel}</div>
                            </div>
                        </div>
                        <div class="attendance-status status-${status}" aria-live="polite" style="min-width:88px;text-align:center;">${status.charAt(0).toUpperCase() + status.slice(1)}</div>
                    </div>
                    <div class="performance-chart" aria-hidden="false">
                        <div class="performance-item">
                            <span>Attendance</span>
                            <strong>${attendance}%</strong>
                        </div>
                        <div class="performance-bar" role="progressbar" aria-valuemin="0" aria-valuemax="100" aria-valuenow="${attendance}" style="width: ${attendance}%;"></div>
                        <div class="performance-item" style="margin-top: 0.5rem;">
                            <span>Performance</span>
                            <strong>${performance}%</strong>
                        </div>
                        <div class="performance-bar" role="progressbar" aria-valuemin="0" aria-valuemax="100" aria-valuenow="${performance}" style="width: ${performance}%;"></div>
                    </div>
                    <div class="attendance-actions">
                        <button class="btn-small btn-success" onclick="markAttendance('${id}', 'present')">Present</button>
                        <button class="btn-small btn-danger" onclick="markAttendance('${id}', 'absent')">Absent</button>
                        <button class="btn-small btn-warning" onclick="markAttendance('${id}', 'late')">Late</button>
                    </div>
                </div>
            `;
        }

        async function loadStudents() {
            const classSelect = document.getElementById('classSelect').value;
            const container = document.getElementById('studentsContainer');

            try {
                const response = await fetch(`/api/students/${classSelect}`);
                if (response.ok) {
                    const apiStudents = await response.json();
                    const localStudents = schoolData.students[classSelect] || [];
                    let students;
                    if (apiStudents && apiStudents.length > 0) {
                        // Prefer API students when available
                        students = apiStudents;
                    } else if (localStudents && localStudents.length > 0) {
                        // If API has none but local storage contains entries (e.g., added while offline), use local
                        students = localStudents;
                    } else {
                        // No real students anywhere ‚Äî show demo
                        students = [
                            { id: `${classSelect}-demo-1`, name: 'Tafadzwa Moyo', status: 'present', attendance: 92, performance: 88, class: classSelect },
                            { id: `${classSelect}-demo-2`, name: 'Rutendo Ncube', status: 'late', attendance: 85, performance: 78, class: classSelect },
                            { id: `${classSelect}-demo-3`, name: 'Tinashe Dube', status: 'absent', attendance: 76, performance: 70, class: classSelect },
                            { id: `${classSelect}-demo-4`, name: 'Chipo Mlambo', status: 'present', attendance: 95, performance: 91, class: classSelect }
                        ];
                        container.innerHTML = '<div style="grid-column: 1/-1; color: #6b6b6b; margin-bottom: 1rem; text-align:left;">Showing demo students (no real students found). Use the Add Student form or login to sync real data.</div>' + students.map(student => renderStudentCard(student, classSelect)).join('');
                        return;
                    }
                    container.innerHTML = students.map(student => renderStudentCard(student, classSelect)).join('');
                } else {
                    // Fallback to local data
                    let students = schoolData.students[classSelect] || [];
                    if (!students || students.length === 0) {
                        // show demo students in local fallback as well
                        students = [
                            { id: `${classSelect}-demo-1`, name: 'Tafadzwa Moyo', status: 'present', attendance: 92, performance: 88, class: classSelect },
                            { id: `${classSelect}-demo-2`, name: 'Rutendo Ncube', status: 'late', attendance: 85, performance: 78, class: classSelect },
                            { id: `${classSelect}-demo-3`, name: 'Tinashe Dube', status: 'absent', attendance: 76, performance: 70, class: classSelect }
                        ];
                        container.innerHTML = '<div style="grid-column: 1/-1; color: #6b6b6b; margin-bottom: 1rem; text-align:left;">Showing demo students (no real students found). Use the Add Student form to create real records.</div>' + students.map(student => renderStudentCard(student, classSelect)).join('');
                    } else {
                        container.innerHTML = students.map(student => renderStudentCard(student, classSelect)).join('');
                    }
                }
            } catch (error) {
                console.error('Error loading students:', error);
                // Fallback to local data
                let students = schoolData.students[classSelect] || [];
                if (!students || students.length === 0) {
                    students = [
                        { id: `${classSelect}-demo-1`, name: 'Tafadzwa Moyo', status: 'present', attendance: 92, performance: 88, class: classSelect },
                        { id: `${classSelect}-demo-2`, name: 'Rutendo Ncube', status: 'late', attendance: 85, performance: 78, class: classSelect },
                        { id: `${classSelect}-demo-3`, name: 'Tinashe Dube', status: 'absent', attendance: 76, performance: 70, class: classSelect }
                    ];
                    container.innerHTML = '<div style="grid-column: 1/-1; color: #6b6b6b; margin-bottom: 1rem; text-align:left;">Showing demo students (no real students found). Use the Add Student form to create real records.</div>' + students.map(student => renderStudentCard(student, classSelect)).join('');
                } else {
                    container.innerHTML = students.map(student => renderStudentCard(student, classSelect)).join('');
                }
            }
        }

        async function markAttendance(studentId, status) {
            const token = localStorage.getItem('token');
            if (token) {
                // Use API
                try {
                    const response = await fetch(`/api/students/${studentId}/attendance`, {
                        method: 'PUT',
                        headers: {
                            'Content-Type': 'application/json',
                            'Authorization': `Bearer ${token}`
                        },
                        body: JSON.stringify({ status })
                    });
                    if (response.ok) {
                        loadStudents();
                        showNotification(`Attendance marked: ${status}`);
                    } else {
                        showNotification('Failed to update attendance', 'error');
                    }
                } catch (error) {
                    console.error('Error updating attendance:', error);
                    showNotification('Error updating attendance', 'error');
                }
            } else {
                // Local fallback
                const classSelect = document.getElementById('classSelect').value;
                const student = schoolData.students[classSelect].find(s => s.id === studentId);
                if (student) {
                    student.status = status;
                    await saveData();
                    loadStudents();
                    showNotification(`Attendance marked: ${student.name} - ${status}`);
                }
            }
        }

        async function addStudent() {
            const classSelect = document.getElementById('classSelect').value;
            const name = document.getElementById('newStudentName').value.trim();
            if (!name) {
                alert('Please enter a student name');
                return;
            }
            const token = localStorage.getItem('token');
            if (token) {
                // Use API
                try {
                    const response = await fetch('/api/students', {
                        method: 'POST',
                        headers: {
                            'Content-Type': 'application/json',
                            'Authorization': `Bearer ${token}`
                        },
                        body: JSON.stringify({
                            name,
                            studentId: `STU${Date.now()}`,
                            class: classSelect,
                            email: '',
                            phone: ''
                        })
                    });
                    if (response.ok) {
                        loadStudents();
                        document.getElementById('newStudentName').value = '';
                        showNotification(`Student ${name} added to ${classSelect}`);
                    } else {
                        const data = await response.json();
                        showNotification(data.message || 'Failed to add student', 'error');
                    }
                } catch (error) {
                    console.error('Error adding student:', error);
                    showNotification('Error adding student', 'error');
                }
            } else {
                // Local fallback
                const newStudent = {
                    id: `${classSelect}-${Date.now()}`,
                    name: name,
                    status: 'present',
                    attendance: Math.floor(Math.random() * 20) + 80,
                    performance: Math.floor(Math.random() * 30) + 70
                };
                if (!schoolData.students[classSelect]) {
                    schoolData.students[classSelect] = [];
                }
                schoolData.students[classSelect].push(newStudent);
                saveData();
                loadStudents();
                document.getElementById('newStudentName').value = '';
                showNotification(`Student ${name} added to ${classSelect}`);
            }
        }

        // Payment functions
        function selectPayment(method) {
            document.getElementById('paymentFormContainer').style.display = 'block';
            document.getElementById('paymentFormContainer').scrollIntoView({ behavior: 'smooth' });
        }

        async function processPayment() {
            const studentName = document.getElementById('studentName').value;
            const studentId = document.getElementById('studentId').value;
            const paymentType = document.getElementById('paymentType').value;
            const amount = document.getElementById('paymentAmount').value;
            const phone = document.getElementById('paymentPhone').value;

            if (!studentName || !studentId || !amount || !phone) {
                alert('Please fill in all fields');
                return;
            }

            const payment = {
                id: Date.now().toString(),
                studentName,
                studentId,
                paymentType,
                amount: parseFloat(amount),
                phone,
                timestamp: new Date().toISOString(),
                status: 'pending'
            };

            schoolData.payments.push(payment);
            await saveData();

            alert(`Payment initiated!\n\nStudent: ${studentName}\nAmount: ${amount}\nPhone: ${phone}\n\nYou will receive a prompt on your phone to complete the payment.`);
            
            // Clear form
            document.getElementById('studentName').value = '';
            document.getElementById('studentId').value = '';
            document.getElementById('paymentAmount').value = '';
            document.getElementById('paymentPhone').value = '';
        }

        // SMS functions
        document.getElementById('smsMessage')?.addEventListener('input', function() {
            document.getElementById('charCount').textContent = this.value.length;
        });

        async function sendSMS() {
            const recipient = document.getElementById('smsRecipient').value;
            const type = document.getElementById('smsType').value;
            const message = document.getElementById('smsMessage').value;

            if (!message) {
                alert('Please enter a message');
                return;
            }

            const sms = {
                id: Date.now().toString(),
                recipient,
                type,
                message,
                timestamp: new Date().toISOString(),
                status: 'sent'
            };

            schoolData.smsHistory.unshift(sms);
            await saveData();

            showNotification('SMS sent successfully!');
            document.getElementById('smsMessage').value = '';
            loadSMSHistory();
        }

        function loadSMSHistory() {
            const container = document.getElementById('smsHistory');
            const history = schoolData.smsHistory.slice(0, 10);
            
            if (history.length === 0) {
                container.innerHTML = '<p style="text-align: center; color: var(--dark-gray);">No messages sent yet</p>';
                return;
            }

            container.innerHTML = history.map(sms => `
                <div class="notice-card" style="margin-bottom: 1rem;">
                    <div class="notice-date">${new Date(sms.timestamp).toLocaleString()}</div>
                    <h4 class="notice-title">To: ${sms.recipient}</h4>
                    <p>${sms.message}</p>
                </div>
            `).join('');
        }

        // Resources functions
        function filterResources(category) {
            document.querySelectorAll('.resources-filter .filter-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            event.target.classList.add('active');
            loadResources(category);
        }

        function loadResources(category = 'all') {
            const container = document.getElementById('resourcesContainer');
            let filtered = schoolData.resources;
            
            if (category !== 'all') {
                if (category === 'papers') {
                    filtered = schoolData.resources.filter(r => r.type === 'Past Paper');
                } else if (category === 'notes') {
                    filtered = schoolData.resources.filter(r => r.type === 'Study Notes');
                } else {
                    filtered = schoolData.resources.filter(r => r.category === category);
                }
            }

            container.innerHTML = filtered.map(resource => `
                <div class="resource-card">
                    <span class="resource-type">${resource.type}</span>
                    <h3 style="color: var(--navy); margin-bottom: 0.5rem;">${resource.title}</h3>
                    <p style="color: var(--dark-gray);">Subject: ${resource.subject}</p>
                    <p style="color: var(--dark-gray);">Year: ${resource.year}</p>
                    <button class="btn" style="margin-top: 1rem;" onclick="downloadResource('${resource.id}')">Download</button>
                </div>
            `).join('');
        }

        function downloadResource(id) {
            showNotification('Resource download started!');
        }

        // Calendar functions
        let currentDate = new Date();

        function loadCalendar() {
            updateCalendarHeader();
            generateCalendar();
        }

        function updateCalendarHeader() {
            const monthNames = ['January', 'February', 'March', 'April', 'May', 'June',
                'July', 'August', 'September', 'October', 'November', 'December'];
            document.getElementById('currentMonth').textContent = 
                `${monthNames[currentDate.getMonth()]} ${currentDate.getFullYear()}`;
        }

        function generateCalendar() {
            const container = document.getElementById('calendarGrid');
            const year = currentDate.getFullYear();
            const month = currentDate.getMonth();
            
            const firstDay = new Date(year, month, 1).getDay();
            const daysInMonth = new Date(year, month + 1, 0).getDate();
            
            let html = '';
            const dayNames = ['Sun', 'Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Sat'];
            
            // Day headers
            dayNames.forEach(day => {
                html += `<div style="font-weight: bold; text-align: center; padding: 0.5rem; color: var(--navy);">${day}</div>`;
            });
            
            // Empty cells for days before month starts
            for (let i = 0; i < firstDay; i++) {
                html += '<div></div>';
            }
            
            // Days of the month
            for (let day = 1; day <= daysInMonth; day++) {
                const dateStr = `${year}-${String(month + 1).padStart(2, '0')}-${String(day).padStart(2, '0')}`;
                const events = schoolData.events.filter(e => e.date === dateStr);
                
                html += `
                    <div class="calendar-day">
                        <div class="day-number">${day}</div>
                        ${events.map(e => `<div class="day-event">${e.title}</div>`).join('')}
                    </div>
                `;
            }
            
            container.innerHTML = html;
        }

        function previousMonth() {
            currentDate.setMonth(currentDate.getMonth() - 1);
            loadCalendar();
        }

        function nextMonth() {
            currentDate.setMonth(currentDate.getMonth() + 1);
            loadCalendar();
        }

        async function addEvent() {
            const title = document.getElementById('eventTitle').value;
            const date = document.getElementById('eventDate').value;
            const type = document.getElementById('eventType').value;

            if (!title || !date) {
                alert('Please fill in all fields');
                return;
            }

            const event = {
                id: Date.now().toString(),
                title,
                date,
                type,
                timestamp: new Date().toISOString()
            };

            schoolData.events.push(event);
            await saveData();

            showNotification('Event added successfully!');
            document.getElementById('eventTitle').value = '';
            document.getElementById('eventDate').value = '';
            loadCalendar();
        }

        // Portfolio functions
        function filterPortfolios(category) {
            document.querySelectorAll('.portfolio-filters .filter-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            event.target.classList.add('active');
            loadPortfolios(category);
        }

        function loadPortfolios(category = 'all') {
            const container = document.getElementById('portfolioContainer');
            let filtered = schoolData.portfolios;
            
            if (category !== 'all') {
                filtered = schoolData.portfolios.filter(p => p.authorType === category);
            }

            container.innerHTML = filtered.map(portfolio => `
                <div class="portfolio-card">
                    <div class="portfolio-image">${portfolio.authorType === 'student' ? 'üéì' : 'üë®‚Äçüè´'}</div>
                    <div class="portfolio-content">
                        <div class="portfolio-author">${portfolio.author}</div>
                        <h3 class="portfolio-title">${portfolio.title}</h3>
                        <p>${portfolio.description}</p>
                        <span class="resource-type" style="margin-top: 1rem;">${portfolio.category}</span>
                    </div>
                </div>
            `).join('');
        }

        function openUploadModal() {
            document.getElementById('uploadModal').classList.add('active');
        }

        function closeUploadModal() {
            document.getElementById('uploadModal').classList.remove('active');
        }

        async function uploadWork() {
            const authorType = document.getElementById('authorType').value;
            const authorName = document.getElementById('authorName').value;
            const workTitle = document.getElementById('workTitle').value;
            const description = document.getElementById('workDescription').value;
            const category = document.getElementById('workCategory').value;

            if (!authorName || !workTitle || !description) {
                alert('Please fill in all fields');
                return;
            }

            const portfolio = {
                id: Date.now().toString(),
                author: authorName,
                authorType,
                title: workTitle,
                description,
                category,
                timestamp: new Date().toISOString()
            };

            schoolData.portfolios.unshift(portfolio);
            await saveData();

            showNotification('Portfolio uploaded successfully!');
            closeUploadModal();
            loadPortfolios();
            
            // Clear form
            document.getElementById('authorName').value = '';
            document.getElementById('workTitle').value = '';
            document.getElementById('workDescription').value = '';
        }

        // Chat functions
        function toggleChat() {
            document.getElementById('chatWindow').classList.toggle('active');
        }

        function handleChatEnter(event) {
            if (event.key === 'Enter') {
                sendChatMessage();
            }
        }

        async function sendChatMessage() {
            const input = document.getElementById('chatInput');
            const message = input.value.trim();
            
            if (!message) return;

            addChatMessage(message, 'user');
            input.value = '';

            try {
                // Use backend API for AI response
                const response = await fetch('/api/chat', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({ message })
                });

                if (response.ok) {
                    const data = await response.json();
                    addChatMessage(data.response, 'bot');
                } else {
                    // Fallback to local response
                    const fallbackResponse = generateAIResponse(message);
                    addChatMessage(fallbackResponse, 'bot');
                }
            } catch (error) {
                console.error('Chat API error:', error);
                const fallbackResponse = generateAIResponse(message);
                addChatMessage(fallbackResponse, 'bot');
            }
        }

        function addChatMessage(text, type) {
            const chatMessages = document.getElementById('chatMessages');
            const messageDiv = document.createElement('div');
            messageDiv.className = `message ${type}`;
            messageDiv.textContent = text;
            chatMessages.appendChild(messageDiv);
            chatMessages.scrollTop = chatMessages.scrollHeight;
        }

        function generateAIResponse(message) {
            const lowerMessage = message.toLowerCase();

            // Fee-related queries
            if (lowerMessage.includes('fee') || lowerMessage.includes('payment') || lowerMessage.includes('pay')) {
                return "You can pay school fees through our payment portal. Click on 'EcoCash Payments' in the features section. We accept EcoCash, OneMoney, and bank transfers. Term fees are due by the 15th of each month.";
            }

            // Exam queries
            if (lowerMessage.includes('exam') || lowerMessage.includes('test') || lowerMessage.includes('zimsec')) {
                return "Exam timetables are available in the Notices section. You can also find ZIMSEC past papers and revision materials in our Resources section. Mid-term exams start next month!";
            }

            // Event queries
            if (lowerMessage.includes('event') || lowerMessage.includes('calendar') || lowerMessage.includes('when')) {
                return "Check our School Calendar for all upcoming events! Sports Day is on February 15th, Parent-Teacher meetings are scheduled for the last Friday of each month.";
            }

            // Resource queries
            if (lowerMessage.includes('paper') || lowerMessage.includes('notes') || lowerMessage.includes('study')) {
                return "Visit our ZIMSEC Resources section for past papers, study notes, and revision guides for all subjects. We have materials for both O-Level and A-Level students!";
            }

            // Attendance queries
            if (lowerMessage.includes('attendance') || lowerMessage.includes('absent') || lowerMessage.includes('present')) {
                return "Parents can view their child's attendance in real-time through our Attendance Tracker. We send SMS notifications for absences. Current term attendance requirement is 85%.";
            }

            // Contact queries
            if (lowerMessage.includes('contact') || lowerMessage.includes('email') || lowerMessage.includes('phone')) {
                return "You can reach us at:\nüìû +263 40067\nüìß info@mbizohigh.ac.zw\nüìç 3VW5+WJF, Mbizo, Kwekwe\nOffice hours: Mon-Fri, 7:30 AM - 4:00 PM";
            }

            // Default response
            return "I can help you with information about fees, exams, events, resources, attendance, and more. What would you like to know?";
        }

        // Admin functions
        function openAdminPanel() {
            document.getElementById('adminModal').classList.add('active');
        }

        function closeAdminPanel() {
            document.getElementById('adminModal').classList.remove('active');
            document.getElementById('loginSection').style.display = 'block';
            document.getElementById('adminSection').style.display = 'none';
            document.getElementById('adminPassword').value = '';
        }

        function verifyAdmin() {
            const password = document.getElementById('adminPassword').value;
            if (password === 'admin123') {
                document.getElementById('loginSection').style.display = 'none';
                document.getElementById('adminSection').style.display = 'block';
            } else {
                alert('Incorrect password!');
            }
        }

        async function addNotice() {
            const title = document.getElementById('noticeTitle').value;
            const content = document.getElementById('noticeContent').value;

            if (!title || !content) {
                alert('Please fill in all fields');
                return;
            }

            const notice = {
                id: Date.now().toString(),
                title,
                content,
                date: new Date().toISOString().split('T')[0],
                timestamp: Date.now()
            };

            schoolData.notices.unshift(notice);
            await saveData();

            showNotification('Notice published successfully!');
            closeAdminPanel();
            loadNotices();
            
            document.getElementById('noticeTitle').value = '';
            document.getElementById('noticeContent').value = '';
        }

        // Load notices
        function loadNotices() {
            const container = document.getElementById('noticesContainer');
            const notices = schoolData.notices.sort((a, b) => b.timestamp - a.timestamp);
            
            if (notices.length === 0) {
                container.innerHTML = '<p style="text-align: center;">No notices available</p>';
                return;
            }

            container.innerHTML = notices.map(notice => `
                <div class="notice-card">
                    <div class="notice-date">${new Date(notice.timestamp).toLocaleDateString('en-GB', {
                        day: 'numeric',
                        month: 'long',
                        year: 'numeric'
                    })}</div>
                    <h3 class="notice-title">${notice.title}</h3>
                    <p class="notice-content">${notice.content}</p>
                </div>
            `).join('');
        }

        // Utility functions
        function showNotification(message) {
            const notification = document.createElement('div');
            notification.className = 'success-message';
            notification.textContent = message;
            notification.style.cssText = `
                position: fixed;
                top: 100px;
                right: 20px;
                z-index: 3000;
                animation: fadeInUp 0.3s ease;
                max-width: 300px;
            `;
            document.body.appendChild(notification);
            setTimeout(() => {
                notification.style.animation = 'fadeOut 0.3s ease';
                setTimeout(() => notification.remove(), 300);
            }, 3000);
        }

        // Scroll animations
        const observerOptions = {
            threshold: 0.2,
            rootMargin: '0px 0px -100px 0px'
        };

        const observer = new IntersectionObserver((entries) => {
            entries.forEach(entry => {
                if (entry.isIntersecting) {
                    entry.target.classList.add('visible');
                }
            });
        }, observerOptions);

        document.querySelectorAll('.fade-in').forEach(el => {
            observer.observe(el);
        });

        // Header scroll effect
        window.addEventListener('scroll', () => {
            const header = document.getElementById('header');
            if (window.scrollY > 100) {
                header.classList.add('scrolled');
            } else {
                header.classList.remove('scrolled');
            }
        });

        // Contact form - Updated to use backend API
        document.getElementById('contactForm').addEventListener('submit', async (e) => {
            e.preventDefault();
            
            const formData = new FormData(e.target);
            const contactData = {
                name: formData.get('name'),
                email: formData.get('email'),
                message: formData.get('message')
            };

            try {
                const response = await fetch('/api/contact', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify(contactData)
                });

                if (response.ok) {
                    showNotification('Message sent successfully! We will get back to you soon.');
                    e.target.reset();
                } else {
                    showNotification('Error sending message. Please try again.', 'error');
                }
            } catch (error) {
                console.error('Contact form error:', error);
                showNotification('Error sending message. Please try again.', 'error');
            }
        });

        // Smooth scroll for navigation
        document.querySelectorAll('a[href^="#"]').forEach(anchor => {
            anchor.addEventListener('click', function (e) {
                e.preventDefault();
                const target = document.querySelector(this.getAttribute('href'));
                if (target) {
                    target.scrollIntoView({
                        behavior: 'smooth',
                        block: 'start'
                    });
                }
            });
        });

        // Initialize on load
        window.addEventListener('DOMContentLoaded', async () => {
            await loadData();
        });
    </script>
    <script src="js/api.js"></script>
</body>
</html>
